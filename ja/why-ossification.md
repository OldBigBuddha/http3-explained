# 硬直化

インターネットは「ネットワークのネットワーク」です。
このネットワークのネットワークを想定通りに動作させるために、インターネット上の様々な場所に機器が設置されています。
これらの機器はネットワーク上に分散して存在していて、これらを「ミドルボックス」と呼んでいます。
ミドルボックスは、ネットワークデータ転送の主役である、２つのエンドポイントの間の、どこかに存在しています。

ミドルボックスは、様々な目的で様々な動作をしていますが、至る所に誰かが設置していると言ってよいでしょう。
その人たちは、そこでその動作をさせなければならないと考えています。

ミドルボックスは、ネットワーク間で IP アドレスのルーティングを行います。
また、悪意のあるトラフィックをブロックします。
さらに、NAT(Network Address Translation)を行ったり、パフォーマンスを向上させます。
いくつかのものは、通過するトラフィックを盗み見ようとしたり、他にもいろいろなことを行うでしょう。

ミドルボックスは、これらの仕事を行うため、ネットワークのことや、プロトコルのことを知っていなければなりません。
監視したり干渉したりするためには必須です。
このために、機器の中でソフトウェアを動かしています。
これらのソフトウェアは頻繁に更新されるとは言い難いものです。

これらはインターネットを保つためのグルーですが、最新の技術を保っていることはなかなかありません。
これらネットワークの内部に存在する典型的な機器は、クライアントやサーバーといった世界の最先端の機器ほどには素早く更新することができないものなのです。

全てのネットワークプロトコルにはこの問題が付いて回ります。
プロトコルを分析して、何を通過させるか、ブロックするかを判断するための機器を設置したとすると、その機器は設置した当時の仕様で動作することになります。
プロトコルに新しい仕様が追加されたり、振る舞いが変わると、このような機器には何か悪いことが起こったとか、不正な操作をされたといった、リスクと見なされることになります。
このようなトラフィックは、単に捨てられたり、あるいはその機能を使用したくないと思うほど遅延させられたりします。

これを「プロトコルの硬直化」と呼んでいます。

TCP も硬直化によって変化が難しい状況にあります。
新しい TCP オプションを不明なものとしてブロックするような機器が、クライアントとサーバーの間にあるかもしれないのです。
プロトコルの詳細が分析できると、それを取り巻くシステムは振る舞いを学習していき、やがて変化ができない状態となるのです。

この硬直化と「戦う」ための真に効果的な唯一の方法は、ミドルボックスがプロトコルの中身を見ることができないように、可能な限り通信を暗号化することなのです。
